# smart-table-handler

多文件的表格处理
主要功能：
1.后端抽象构建了一套的解析框架
通过一些开源库（jsoup、spirepdf、PDFPlumber、Tabula、poi）构建成解析组件，用来分别识别pdf、word、html中的表格数据，然后对这些表格数据根据配置的规则进行数据处理和抽取，同时处理一些可能因为跨页导致单元格被切割、同标题表格合并、单位处理等问题
2.在数据库建相关配置表，对应到解析组件中设置
3.前端在页面对配置表，进行相关操作(crud).
4.程序转化表数据成解析组件。进行解析，落库，导出解析结果到excel
5.除了表格解析，在页面配置正则表达式对文档内容进行正则提取，以获取某些文本中的关键内容。

大体设计流程：简单流程串联：
1.解析资源处理：上传文件资源包->解压文件->单个文件入库
2.解析：获取所有文件->解析器解析：循环文件解析成文本、表格->
抽取器抽取：循环文件进行处理（表格抽取、正则抽取、调用第三方大模型api库）->解析结果入库 ->导出

* map支持多个，一列一列的填； √
* 单个表的导出完善；√
* 测试word、html的解析； √
* 重构、支持组合表格解析、库使用√
* 解析抽取、串联√
* 并发、批量异步处理√
* 导出处理 √
* 多行标题 √
* 前端正则必须有括号 √
* list抽取代码前端优化 √
* 单位提前处理 √
* list多列标题 √
* list多列标题支持模糊、精确 √
todo:未做：
* map支持模糊
* 打成第三方包

从指定的位置获取到资源(各种资源)，然后页面配置规则解析（rule 保存到数据库中）,规则的增删改查，解析结果输出到页面（落库\excel\不好存？）
1个资源 对应 n个解析配置
1.获取到资源:
资源的crud；
为资源配置详情；
资源的解析按钮；
资源上传(各类文件，pdf、excel、word、html)；
2.rule配置：每个资源可配置多个rule
rule的crud；
解析器配置；spire、py、
3.解析：
资源id、文件名称、规则id、 loss